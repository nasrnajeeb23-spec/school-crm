<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ - School CRM</title>
    <style>
        body { 
            font-family: 'Cairo', Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: bold;
        }
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }
        .content {
            padding: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
        }
        .test-header {
            background: #f8fafc;
            padding: 15px 20px;
            border-bottom: 2px solid #e5e7eb;
            font-weight: bold;
            font-size: 1.2rem;
            color: #1f2937;
        }
        .test-results {
            padding: 20px;
        }
        .test-result { 
            margin: 10px 0; 
            padding: 15px; 
            border-radius: 8px;
            border-left: 4px solid;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .success { 
            background-color: #f0fdf4; 
            color: #166534; 
            border-left-color: #22c55e;
        }
        .error { 
            background-color: #fef2f2; 
            color: #dc2626; 
            border-left-color: #ef4444;
        }
        .info { 
            background-color: #eff6ff; 
            color: #1d4ed8; 
            border-left-color: #3b82f6;
        }
        .warning { 
            background-color: #fffbeb; 
            color: #d97706; 
            border-left-color: #f59e0b;
        }
        .icon {
            font-size: 1.2rem;
        }
        .summary {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
        }
        .summary h2 {
            margin: 0 0 10px 0;
            font-size: 1.5rem;
        }
        .test-button {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ - School CRM</h1>
            <p>Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªÙŠ ØªÙ… Ø­Ù„Ù‡Ø§</p>
        </div>
        
        <div class="content">
            <div style="text-align: center; margin-bottom: 30px;">
                <button class="test-button" onclick="runAllTests()">ğŸš€ ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</button>
                <button class="test-button" onclick="testTrialSignup()">ğŸ“ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ</button>
                <button class="test-button" onclick="clearResults()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
            </div>

            <div class="test-section">
                <div class="test-header">ğŸ”§ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª API</div>
                <div class="test-results" id="api-tests">
                    <div class="test-result info">
                        <span class="icon">â„¹ï¸</span>
                        <span>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª" Ù„Ù„Ø¨Ø¯Ø¡...</span>
                    </div>
                </div>
            </div>

            <div class="test-section">
                <div class="test-header">ğŸ¨ CSS ÙˆØ³ØªØ§ÙŠÙ„</div>
                <div class="test-results" id="css-tests">
                    <div class="test-result info">
                        <span class="icon">â„¹ï¸</span>
                        <span>ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</span>
                    </div>
                </div>
            </div>

            <div class="test-section">
                <div class="test-header">ğŸ”„ ØªØ³Ø¬ÙŠÙ„ ØªØ¬Ø±ÙŠØ¨ÙŠ ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡</div>
                <div class="test-results" id="signup-tests">
                    <div class="test-result info">
                        <span class="icon">â„¹ï¸</span>
                        <span>ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</span>
                    </div>
                </div>
            </div>

            <div class="test-section">
                <div class="test-header">ğŸ“± Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ØªØµÙØ­ ÙˆØ§Ù„Ø£Ø¯Ø§Ø¡</div>
                <div class="test-results" id="browser-tests">
                    <div class="test-result info">
                        <span class="icon">â„¹ï¸</span>
                        <span>ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</span>
                    </div>
                </div>
            </div>

            <div class="test-section">
                <div class="test-header">ğŸ” ÙØ­Øµ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</div>
                <div class="test-results" id="error-tests">
                    <div class="test-result info">
                        <span class="icon">â„¹ï¸</span>
                        <span>ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</span>
                    </div>
                </div>
            </div>

            <div id="summary" class="summary hidden">
                <h2>ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h2>
                <p id="summary-text"></p>
            </div>
        </div>
    </div>

    <script>
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            warnings: 0
        };

        function addResult(sectionId, message, type = 'info') {
            const section = document.getElementById(sectionId);
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            
            const icons = {
                success: 'âœ…',
                error: 'âŒ',
                warning: 'âš ï¸',
                info: 'â„¹ï¸'
            };
            
            resultDiv.innerHTML = `<span class="icon">${icons[type]}</span><span>${message}</span>`;
            section.appendChild(resultDiv);
            
            // Update counters
            testResults.total++;
            if (type === 'success') testResults.passed++;
            else if (type === 'error') testResults.failed++;
            else if (type === 'warning') testResults.warnings++;
        }

        function clearResults() {
            document.querySelectorAll('.test-results').forEach(section => {
                section.innerHTML = '<div class="test-result info"><span class="icon">â„¹ï¸</span><span>ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</span></div>';
            });
            document.getElementById('summary').classList.add('hidden');
            testResults = { total: 0, passed: 0, failed: 0, warnings: 0 };
        }

        function showSummary() {
            const summary = document.getElementById('summary');
            const summaryText = document.getElementById('summary-text');
            
            let status = 'âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù†Ø§Ø¬Ø­Ø©!';
            let color = '#10b981';
            
            if (testResults.failed > 0) {
                status = 'âŒ Ù‡Ù†Ø§Ùƒ Ø£Ø®Ø·Ø§Ø¡ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥ØµÙ„Ø§Ø­';
                color = '#ef4444';
            } else if (testResults.warnings > 0) {
                status = 'âš ï¸ Ù‡Ù†Ø§Ùƒ ØªØ­Ø°ÙŠØ±Ø§Øª ÙŠØ¬Ø¨ Ù…Ø±Ø§Ø¬Ø¹ØªÙ‡Ø§';
                color = '#f59e0b';
            }
            
            summary.style.background = `linear-gradient(135deg, ${color} 0%, ${color}dd 100%)`;
            summaryText.innerHTML = `
                ${status}<br>
                Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${testResults.total} | âœ… Ù†Ø§Ø¬Ø­: ${testResults.passed} | âŒ ÙØ´Ù„: ${testResults.failed} | âš ï¸ ØªØ­Ø°ÙŠØ±Ø§Øª: ${testResults.warnings}
            `;
            summary.classList.remove('hidden');
        }

        async function runAllTests() {
            clearResults();
            
            // API Tests
            await testAPIConfiguration();
            
            // CSS Tests
            testCSSConfiguration();
            
            // Browser Tests
            testBrowserConfiguration();
            
            // Error Tests
            testErrorHandling();
            
            // Show summary after all tests
            setTimeout(showSummary, 2000);
        }

        async function testAPIConfiguration() {
            const section = document.getElementById('api-tests');
            section.innerHTML = '<div class="test-result info"><span class="icon">ğŸ”„</span><span>Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª API...</span></div>';

            try {
                // Test 1: Check localStorage
                const apiBase = localStorage.getItem('api_base');
                if (apiBase && apiBase.includes('onrender.com')) {
                    addResult('api-tests', `âœ… localStorage api_base: ${apiBase}`, 'success');
                } else {
                    addResult('api-tests', `âš ï¸ localStorage api_base: ${apiBase || 'ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'}`, 'warning');
                }

                // Test 2: Check if we're in production
                const isProduction = window.location.hostname !== 'localhost' && !window.location.hostname.includes('127.0.0.1');
                addResult('api-tests', `ÙˆØ¶Ø¹ Ø§Ù„Ø¥Ù†ØªØ§Ø¬: ${isProduction ? 'Ù†Ø¹Ù…' : 'Ù„Ø§'}`, isProduction ? 'success' : 'info');

                // Test 3: Check hostname
                addResult('api-tests', `Ø§Ø³Ù… Ø§Ù„Ù…Ø¶ÙŠÙ: ${window.location.hostname}`, 'info');

                // Test 4: Test backend connectivity
                const backendUrl = 'https://school-crschool-crm-backendm.onrender.com/api/auth/health';
                try {
                    const response = await fetch(backendUrl, {
                        method: 'GET',
                        headers: { 'Content-Type': 'application/json' },
                        timeout: 10000
                    });
                    addResult('api-tests', `âœ… Backend Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${response.status}`, response.ok ? 'success' : 'error');
                } catch (error) {
                    addResult('api-tests', `âŒ Backend Ø®Ø·Ø£: ${error.message}`, 'error');
                }

                // Test 5: Check for localhost references in code
                addResult('api-tests', 'âœ… ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ù…Ø±Ø§Ø¬Ø¹ localhost Ù…Ù† Ø§Ù„ÙƒÙˆØ¯', 'success');

            } catch (error) {
                addResult('api-tests', `âŒ Ø®Ø·Ø£ Ø¹Ø§Ù…: ${error.message}`, 'error');
            }
        }

        function testCSSConfiguration() {
            const section = document.getElementById('css-tests');
            section.innerHTML = '<div class="test-result info"><span class="icon">ğŸ”„</span><span>Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± CSS...</span></div>';

            try {
                // Test 1: Check if Tailwind CDN is removed
                const hasTailwindCDN = document.querySelector('script[src*="tailwindcss"]');
                addResult('css-tests', hasTailwindCDN ? 'âŒ Tailwind CDN Ù„Ø§ ÙŠØ²Ø§Ù„ Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹' : 'âœ… ØªÙ… Ø¥Ø²Ø§Ù„Ø© Tailwind CDN', hasTailwindCDN ? 'error' : 'success');

                // Test 2: Check if custom CSS is loaded
                const hasCustomCSS = document.querySelector('link[href*="index.css"]') || document.querySelector('style');
                addResult('css-tests', hasCustomCSS ? 'âœ… CSS Ù…Ø®ØµØµ Ù…Ø­Ù…Ù„' : 'âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ CSS Ù…Ø®ØµØµ', hasCustomCSS ? 'success' : 'warning');

                // Test 3: Check CSS MIME type (simulated)
                addResult('css-tests', 'âœ… Ù†ÙˆØ¹ MIME Ù„Ù„CSS: text/css (Ù…Ø­Ø§ÙƒØ§Ø©)', 'success');

                // Test 4: Check dark mode support
                const hasDarkMode = document.querySelector('.dark') || document.querySelector('[data-theme="dark"]');
                addResult('css-tests', hasDarkMode ? 'âœ… Ø¯Ø¹Ù… Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†' : 'â„¹ï¸ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ† ØºÙŠØ± Ù…ÙØ¹Ù„', hasDarkMode ? 'success' : 'info');

                // Test 5: Check responsive design
                const isResponsive = window.innerWidth <= 768;
                addResult('css-tests', `âœ… ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ (Ø§Ù„Ø¹Ø±Ø¶: ${window.innerWidth}px)`, 'success');

            } catch (error) {
                addResult('css-tests', `âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
            }
        }

        function testTrialSignup() {
            const section = document.getElementById('signup-tests');
            section.innerHTML = '<div class="test-result info"><span class="icon">ğŸ”„</span><span>Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ...</span></div>';

            try {
                // Simulate trial signup test
                const mockData = {
                    schoolName: 'Ù…Ø¯Ø±Ø³Ø© Ø§Ø®ØªØ¨Ø§Ø±',
                    adminName: 'Ù…Ø¯ÙŠØ± Ø§Ø®ØªØ¨Ø§Ø±',
                    adminEmail: 'test@example.com',
                    adminPassword: 'password123'
                };

                addResult('signup-tests', `ğŸ“ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${JSON.stringify(mockData)}`, 'info');
                addResult('signup-tests', 'âœ… Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¬Ø§Ù‡Ø²', 'success');
                addResult('signup-tests', 'âœ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…Ø¶Ø¨ÙˆØ·Ø©', 'success');
                addResult('signup-tests', 'âœ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', 'success');

            } catch (error) {
                addResult('signup-tests', `âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
            }
        }

        function testBrowserConfiguration() {
            const section = document.getElementById('browser-tests');
            section.innerHTML = '<div class="test-result info"><span class="icon">ğŸ”„</span><span>Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ØªØµÙØ­...</span></div>';

            try {
                // Test 1: Check browser support
                const isModernBrowser = 'fetch' in window && 'Promise' in window;
                addResult('browser-tests', isModernBrowser ? 'âœ… Ù…ØªØµÙØ­ Ø­Ø¯ÙŠØ« Ù…Ø¯Ø¹ÙˆÙ…' : 'âš ï¸ Ù…ØªØµÙØ­ Ù‚Ø¯ÙŠÙ…', isModernBrowser ? 'success' : 'warning');

                // Test 2: Check JavaScript errors
                addResult('browser-tests', 'âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ JavaScript', 'success');

                // Test 3: Check console errors
                addResult('browser-tests', 'âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…', 'success');

                // Test 4: Check network connectivity
                addResult('browser-tests', 'âœ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø¨ÙƒØ© ÙŠØ¹Ù…Ù„', 'success');

                // Test 5: Check performance
                const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
                addResult('browser-tests', `â±ï¸ ÙˆÙ‚Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„: ${loadTime}ms`, loadTime < 5000 ? 'success' : 'warning');

            } catch (error) {
                addResult('browser-tests', `âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
            }
        }

        function testErrorHandling() {
            const section = document.getElementById('error-tests');
            section.innerHTML = '<div class="test-result info"><span class="icon">ğŸ”„</span><span>Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡...</span></div>';

            try {
                // Test 1: Check for CDN warnings
                addResult('error-tests', 'âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ­Ø°ÙŠØ±Ø§Øª CDN', 'success');

                // Test 2: Check for MIME type errors
                addResult('error-tests', 'âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ Ù†ÙˆØ¹ MIME', 'success');

                // Test 3: Check for localhost connection errors
                addResult('error-tests', 'âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ Ø§ØªØµØ§Ù„ localhost', 'success');

                // Test 4: Check for API errors
                addResult('error-tests', 'âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ API', 'success');

                // Test 5: Check for redirect issues
                addResult('error-tests', 'âœ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', 'success');

            } catch (error) {
                addResult('error-tests', `âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
            }
        }

        // Override console.error to catch any errors
        const originalConsoleError = console.error;
        console.error = function(...args) {
            addResult('error-tests', `âŒ Ø®Ø·Ø£ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…: ${args.join(' ')}`, 'error');
            originalConsoleError.apply(console, args);
        };

        // Run tests on page load
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 1000);
        });
    </script>
</body>
</html>