<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± API Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; direction: rtl; }
        .test-section { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        .result { margin: 10px 0; padding: 10px; background: white; border-radius: 3px; }
        button { padding: 10px 15px; margin: 5px; border: none; border-radius: 3px; cursor: pointer; }
        .test-btn { background: #007bff; color: white; }
        .clear-btn { background: #6c757d; color: white; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</h1>
    
    <div class="test-section">
        <h3>1. Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
        <button class="test-btn" onclick="testSuperAdminLogin()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…</button>
        <button class="test-btn" onclick="testSchoolAdminLogin()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</button>
        <button class="test-btn" onclick="testParentLogin()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</button>
        <button class="test-btn" onclick="testInvalidLogin()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø®Ø§Ø·Ø¦</button>
    </div>

    <div class="test-section">
        <h3>2. Ø§Ø®ØªØ¨Ø§Ø± Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…</h3>
        <button class="test-btn" onclick="testSuperAdminDashboard()">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</button>
        <button class="test-btn" onclick="testSchoolsList()">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</button>
        <button class="test-btn" onclick="testSchoolAdminsList()">Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</button>
        <button class="test-btn" onclick="testSubscriptions()">Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</button>
    </div>

    <div class="test-section">
        <h3>3. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ</h3>
        <button class="test-btn" onclick="testInvoices()">Ø§Ù„ÙÙˆØ§ØªÙŠØ±</button>
        <button class="test-btn" onclick="testExpenses()">Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ</button>
        <button class="test-btn" onclick="testPayments()">Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</button>
    </div>

    <div class="test-section">
        <h3>4. Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ù„</h3>
        <button class="test-btn" onclick="testTransportation()">Ø§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª</button>
        <button class="test-btn" onclick="testBusOperators()">Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</button>
        <button class="test-btn" onclick="testRoutes()">Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª</button>
    </div>

    <div class="test-section">
        <h3>5. Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø¹Ù„Ù…</h3>
        <button class="test-btn" onclick="testTeacherDashboard()">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¹Ù„Ù…</button>
        <button class="test-btn" onclick="testTeacherClasses()">ØµÙÙˆÙ Ø§Ù„Ù…Ø¹Ù„Ù…</button>
        <button class="test-btn" onclick="testAssignments()">Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª</button>
    </div>

    <div class="test-section">
        <h3>6. Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¸Ø§Ø¦Ù ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</h3>
        <button class="test-btn" onclick="testParentDashboard()">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</button>
        <button class="test-btn" onclick="testParentGrades()">Ø§Ù„Ø¯Ø±Ø¬Ø§Øª</button>
        <button class="test-btn" onclick="testParentAttendance()">Ø§Ù„Ø­Ø¶ÙˆØ±</button>
    </div>

    <div class="test-section">
        <h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
        <button class="clear-btn" onclick="clearResults()">Ù…Ø³Ø­ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
        <div id="results"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:5000/api';
        let authToken = null;
        let currentUser = null;

        function addResult(testName, success, data, error = null) {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = 'result';
            resultDiv.innerHTML = `
                <strong>${testName}:</strong> 
                <span class="${success ? 'success' : 'error'}">
                    ${success ? 'âœ… Ù†Ø§Ø¬Ø­' : 'âŒ ÙØ´Ù„'}
                </span>
                ${data ? `<br><small>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${JSON.stringify(data, null, 2)}</small>` : ''}
                ${error ? `<br><small class="error">Ø§Ù„Ø®Ø·Ø£: ${error}</small>` : ''}
            `;
            resultsDiv.insertBefore(resultDiv, resultsDiv.firstChild);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        // Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
        async function testSuperAdminLogin() {
            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: 'super@admin.com', password: 'password' })
                });
                const data = await response.json();
                if (data.user && data.user.role === 'SuperAdmin') {
                    authToken = data.token;
                    currentUser = data.user;
                    addResult('Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…', true, data);
                } else {
                    addResult('Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…', false, data, 'ØµÙ„Ø§Ø­ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                }
            } catch (error) {
                addResult('Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…', false, null, error.message);
            }
        }

        async function testSchoolAdminLogin() {
            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: 'admin@school.com', password: 'password' })
                });
                const data = await response.json();
                if (data.user && data.user.role === 'SchoolAdmin') {
                    addResult('Ø¯Ø®ÙˆÙ„ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©', true, data);
                } else {
                    addResult('Ø¯Ø®ÙˆÙ„ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©', false, data, 'ØµÙ„Ø§Ø­ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                }
            } catch (error) {
                addResult('Ø¯Ø®ÙˆÙ„ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©', false, null, error.message);
            }
        }

        async function testParentLogin() {
            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: 'parent@school.com', password: 'password' })
                });
                const data = await response.json();
                if (data.user && data.user.role === 'Parent') {
                    addResult('Ø¯Ø®ÙˆÙ„ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±', true, data);
                } else {
                    addResult('Ø¯Ø®ÙˆÙ„ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±', false, data, 'ØµÙ„Ø§Ø­ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                }
            } catch (error) {
                addResult('Ø¯Ø®ÙˆÙ„ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±', false, null, error.message);
            }
        }

        async function testInvalidLogin() {
            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: 'invalid@user.com', password: 'wrongpassword' })
                });
                const data = await response.json();
                addResult('Ø¯Ø®ÙˆÙ„ Ø®Ø§Ø·Ø¦ (ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙØ´Ù„)', !data.user, data);
            } catch (error) {
                addResult('Ø¯Ø®ÙˆÙ„ Ø®Ø§Ø·Ø¦', true, null, 'ÙØ´Ù„ ÙƒÙ…Ø§ Ù‡Ùˆ Ù…ØªÙˆÙ‚Ø¹');
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…
        async function testSuperAdminDashboard() {
            if (!authToken) {
                addResult('Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…', false, null, 'ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            try {
                const response = await fetch(`${API_BASE}/superadmin/stats`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const data = await response.json();
                addResult('Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…', response.ok, data);
            } catch (error) {
                addResult('Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…', false, null, error.message);
            }
        }

        async function testSchoolsList() {
            try {
                const response = await fetch(`${API_BASE}/schools`);
                const data = await response.json();
                addResult('Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³', response.ok, data);
            } catch (error) {
                addResult('Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³', false, null, error.message);
            }
        }

        async function testSchoolAdminsList() {
            if (!authToken) {
                addResult('Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³', false, null, 'ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            try {
                const response = await fetch(`${API_BASE}/superadmin/users?role=SchoolAdmin`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const data = await response.json();
                addResult('Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³', response.ok, data);
            } catch (error) {
                addResult('Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³', false, null, error.message);
            }
        }

        async function testSubscriptions() {
            if (!authToken) {
                addResult('Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª', false, null, 'ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            try {
                const response = await fetch(`${API_BASE}/superadmin/subscriptions`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const data = await response.json();
                addResult('Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª', response.ok, data);
            } catch (error) {
                addResult('Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª', false, null, error.message);
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ
        async function testInvoices() {
            try {
                const response = await fetch(`${API_BASE}/invoices`);
                const data = await response.json();
                addResult('Ø§Ù„ÙÙˆØ§ØªÙŠØ±', response.ok, data);
            } catch (error) {
                addResult('Ø§Ù„ÙÙˆØ§ØªÙŠØ±', false, null, error.message);
            }
        }

        async function testExpenses() {
            try {
                const response = await fetch(`${API_BASE}/expenses`);
                const data = await response.json();
                addResult('Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ', response.ok, data);
            } catch (error) {
                addResult('Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ', false, null, error.message);
            }
        }

        async function testPayments() {
            try {
                const response = await fetch(`${API_BASE}/payments`);
                const data = await response.json();
                addResult('Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª', response.ok, data);
            } catch (error) {
                addResult('Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª', false, null, error.message);
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù†Ù‚Ù„
        async function testTransportation() {
            try {
                const response = await fetch(`${API_BASE}/transportation`);
                const data = await response.json();
                addResult('Ø§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª', response.ok, data);
            } catch (error) {
                addResult('Ø§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª', false, null, error.message);
            }
        }

        async function testBusOperators() {
            try {
                const response = await fetch(`${API_BASE}/bus-operators`);
                const data = await response.json();
                addResult('Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†', response.ok, data);
            } catch (error) {
                addResult('Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†', false, null, error.message);
            }
        }

        async function testRoutes() {
            try {
                const response = await fetch(`${API_BASE}/routes`);
                const data = await response.json();
                addResult('Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª', response.ok, data);
            } catch (error) {
                addResult('Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª', false, null, error.message);
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…
        async function testTeacherDashboard() {
            try {
                const response = await fetch(`${API_BASE}/teacher/dashboard`);
                const data = await response.json();
                addResult('Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¹Ù„Ù…', response.ok, data);
            } catch (error) {
                addResult('Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¹Ù„Ù…', false, null, error.message);
            }
        }

        async function testTeacherClasses() {
            try {
                const response = await fetch(`${API_BASE}/teacher/classes`);
                const data = await response.json();
                addResult('ØµÙÙˆÙ Ø§Ù„Ù…Ø¹Ù„Ù…', response.ok, data);
            } catch (error) {
                addResult('ØµÙÙˆÙ Ø§Ù„Ù…Ø¹Ù„Ù…', false, null, error.message);
            }
        }

        async function testAssignments() {
            try {
                const response = await fetch(`${API_BASE}/assignments`);
                const data = await response.json();
                addResult('Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª', response.ok, data);
            } catch (error) {
                addResult('Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª', false, null, error.message);
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
        async function testParentDashboard() {
            try {
                const response = await fetch(`${API_BASE}/parent/dashboard`);
                const data = await response.json();
                addResult('Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±', response.ok, data);
            } catch (error) {
                addResult('Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±', false, null, error.message);
            }
        }

        async function testParentGrades() {
            try {
                const response = await fetch(`${API_BASE}/parent/grades`);
                const data = await response.json();
                addResult('Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨', response.ok, data);
            } catch (error) {
                addResult('Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨', false, null, error.message);
            }
        }

        async function testParentAttendance() {
            try {
                const response = await fetch(`${API_BASE}/parent/attendance`);
                const data = await response.json();
                addResult('Ø­Ø¶ÙˆØ± Ø§Ù„Ø·Ø§Ù„Ø¨', response.ok, data);
            } catch (error) {
                addResult('Ø­Ø¶ÙˆØ± Ø§Ù„Ø·Ø§Ù„Ø¨', false, null, error.message);
            }
        }
    </script>
</body>
</html>